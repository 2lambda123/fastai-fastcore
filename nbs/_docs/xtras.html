<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Utility functions used in the fastai library">

<title>fastcore - Utility functions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="fastcore - Utility functions">
<meta property="og:description" content="Utility functions used in the fastai library">
<meta property="og:site-name" content="fastcore">
<meta name="twitter:title" content="fastcore - Utility functions">
<meta name="twitter:description" content="Utility functions used in the fastai library">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">fastcore</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/fastai/fastcore/"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Utility functions</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome to fastcore</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test.html" class="sidebar-item-text sidebar-link">Test</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basics.html" class="sidebar-item-text sidebar-link">Basic functionality</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundation.html" class="sidebar-item-text sidebar-link">Foundation</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./xtras.html" class="sidebar-item-text sidebar-link active">Utility functions</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./parallel.html" class="sidebar-item-text sidebar-link">Parallel</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./net.html" class="sidebar-item-text sidebar-link">Network functionality</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dispatch.html" class="sidebar-item-text sidebar-link">Type dispatch</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./transform.html" class="sidebar-item-text sidebar-link">Transforms</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./docments.html" class="sidebar-item-text sidebar-link">Docments</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./meta.html" class="sidebar-item-text sidebar-link">Meta</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./script.html" class="sidebar-item-text sidebar-link">Script - CLI</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./xdg.html" class="sidebar-item-text sidebar-link">XDG</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#file-functions" id="toc-file-functions" class="nav-link active" data-scroll-target="#file-functions">File Functions</a>
  <ul class="collapse">
  <li><a href="#walk" id="toc-walk" class="nav-link" data-scroll-target="#walk">walk</a></li>
  <li><a href="#globtastic" id="toc-globtastic" class="nav-link" data-scroll-target="#globtastic">globtastic</a></li>
  <li><a href="#maybe_open" id="toc-maybe_open" class="nav-link" data-scroll-target="#maybe_open">maybe_open</a></li>
  <li><a href="#image_size" id="toc-image_size" class="nav-link" data-scroll-target="#image_size">image_size</a></li>
  <li><a href="#bunzip" id="toc-bunzip" class="nav-link" data-scroll-target="#bunzip">bunzip</a></li>
  <li><a href="#loads" id="toc-loads" class="nav-link" data-scroll-target="#loads">loads</a></li>
  <li><a href="#loads_multi" id="toc-loads_multi" class="nav-link" data-scroll-target="#loads_multi">loads_multi</a></li>
  <li><a href="#dumps" id="toc-dumps" class="nav-link" data-scroll-target="#dumps">dumps</a></li>
  <li><a href="#untar_dir" id="toc-untar_dir" class="nav-link" data-scroll-target="#untar_dir">untar_dir</a></li>
  <li><a href="#repo_details" id="toc-repo_details" class="nav-link" data-scroll-target="#repo_details">repo_details</a></li>
  <li><a href="#run" id="toc-run" class="nav-link" data-scroll-target="#run">run</a></li>
  <li><a href="#open_file" id="toc-open_file" class="nav-link" data-scroll-target="#open_file">open_file</a></li>
  <li><a href="#save_pickle" id="toc-save_pickle" class="nav-link" data-scroll-target="#save_pickle">save_pickle</a></li>
  <li><a href="#load_pickle" id="toc-load_pickle" class="nav-link" data-scroll-target="#load_pickle">load_pickle</a></li>
  </ul></li>
  <li><a href="#collections" id="toc-collections" class="nav-link" data-scroll-target="#collections">Collections</a>
  <ul class="collapse">
  <li><a href="#dict2obj" id="toc-dict2obj" class="nav-link" data-scroll-target="#dict2obj">dict2obj</a></li>
  <li><a href="#obj2dict" id="toc-obj2dict" class="nav-link" data-scroll-target="#obj2dict">obj2dict</a></li>
  <li><a href="#repr_dict" id="toc-repr_dict" class="nav-link" data-scroll-target="#repr_dict">repr_dict</a></li>
  <li><a href="#is_listy" id="toc-is_listy" class="nav-link" data-scroll-target="#is_listy">is_listy</a></li>
  <li><a href="#mapped" id="toc-mapped" class="nav-link" data-scroll-target="#mapped">mapped</a></li>
  </ul></li>
  <li><a href="#extensions-to-pathlib.path" id="toc-extensions-to-pathlib.path" class="nav-link" data-scroll-target="#extensions-to-pathlib.path">Extensions to Pathlib.Path</a>
  <ul class="collapse">
  <li><a href="#path.readlines" id="toc-path.readlines" class="nav-link" data-scroll-target="#path.readlines">Path.readlines</a></li>
  <li><a href="#path.read_json" id="toc-path.read_json" class="nav-link" data-scroll-target="#path.read_json">Path.read_json</a></li>
  <li><a href="#path.mk_write" id="toc-path.mk_write" class="nav-link" data-scroll-target="#path.mk_write">Path.mk_write</a></li>
  <li><a href="#path.relpath" id="toc-path.relpath" class="nav-link" data-scroll-target="#path.relpath">Path.relpath</a></li>
  <li><a href="#path.ls" id="toc-path.ls" class="nav-link" data-scroll-target="#path.ls">Path.ls</a></li>
  <li><a href="#path.delete" id="toc-path.delete" class="nav-link" data-scroll-target="#path.delete">Path.delete</a></li>
  </ul></li>
  <li><a href="#reindexing-collections" id="toc-reindexing-collections" class="nav-link" data-scroll-target="#reindexing-collections">Reindexing Collections</a>
  <ul class="collapse">
  <li><a href="#iterlen" id="toc-iterlen" class="nav-link" data-scroll-target="#iterlen">IterLen</a></li>
  <li><a href="#reindexcollection" id="toc-reindexcollection" class="nav-link" data-scroll-target="#reindexcollection">ReindexCollection</a>
  <ul class="collapse">
  <li><a href="#reindexcollection.reindex" id="toc-reindexcollection.reindex" class="nav-link" data-scroll-target="#reindexcollection.reindex">ReindexCollection.reindex</a></li>
  <li><a href="#reindexcollection.cache_clear" id="toc-reindexcollection.cache_clear" class="nav-link" data-scroll-target="#reindexcollection.cache_clear">ReindexCollection.cache_clear</a></li>
  <li><a href="#reindexcollection.shuffle" id="toc-reindexcollection.shuffle" class="nav-link" data-scroll-target="#reindexcollection.shuffle">ReindexCollection.shuffle</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#other-helpers" id="toc-other-helpers" class="nav-link" data-scroll-target="#other-helpers">Other Helpers</a>
  <ul class="collapse">
  <li><a href="#get_source_link" id="toc-get_source_link" class="nav-link" data-scroll-target="#get_source_link">get_source_link</a></li>
  <li><a href="#truncstr" id="toc-truncstr" class="nav-link" data-scroll-target="#truncstr">truncstr</a></li>
  <li><a href="#sparkline" id="toc-sparkline" class="nav-link" data-scroll-target="#sparkline">sparkline</a></li>
  <li><a href="#modify_exception" id="toc-modify_exception" class="nav-link" data-scroll-target="#modify_exception">modify_exception</a></li>
  <li><a href="#round_multiple" id="toc-round_multiple" class="nav-link" data-scroll-target="#round_multiple">round_multiple</a></li>
  <li><a href="#set_num_threads" id="toc-set_num_threads" class="nav-link" data-scroll-target="#set_num_threads">set_num_threads</a></li>
  <li><a href="#join_path_file" id="toc-join_path_file" class="nav-link" data-scroll-target="#join_path_file">join_path_file</a></li>
  </ul></li>
  <li><a href="#other-helpers-1" id="toc-other-helpers-1" class="nav-link" data-scroll-target="#other-helpers-1">Other Helpers</a>
  <ul class="collapse">
  <li><a href="#autostart" id="toc-autostart" class="nav-link" data-scroll-target="#autostart">autostart</a></li>
  <li><a href="#eventtimer" id="toc-eventtimer" class="nav-link" data-scroll-target="#eventtimer">EventTimer</a>
  <ul class="collapse">
  <li><a href="#stringfmt_names" id="toc-stringfmt_names" class="nav-link" data-scroll-target="#stringfmt_names">stringfmt_names</a></li>
  </ul></li>
  <li><a href="#partialformatter" id="toc-partialformatter" class="nav-link" data-scroll-target="#partialformatter">PartialFormatter</a>
  <ul class="collapse">
  <li><a href="#partial_format" id="toc-partial_format" class="nav-link" data-scroll-target="#partial_format">partial_format</a></li>
  <li><a href="#utc2local" id="toc-utc2local" class="nav-link" data-scroll-target="#utc2local">utc2local</a></li>
  <li><a href="#local2utc" id="toc-local2utc" class="nav-link" data-scroll-target="#local2utc">local2utc</a></li>
  <li><a href="#trace" id="toc-trace" class="nav-link" data-scroll-target="#trace">trace</a></li>
  <li><a href="#modified_env" id="toc-modified_env" class="nav-link" data-scroll-target="#modified_env">modified_env</a></li>
  </ul></li>
  <li><a href="#contextmanagers" id="toc-contextmanagers" class="nav-link" data-scroll-target="#contextmanagers">ContextManagers</a>
  <ul class="collapse">
  <li><a href="#shufflish" id="toc-shufflish" class="nav-link" data-scroll-target="#shufflish">shufflish</a></li>
  <li><a href="#console_help" id="toc-console_help" class="nav-link" data-scroll-target="#console_help">console_help</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/fastai/fastcore/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Utility functions</h1>
</div>

<div>
  <div class="description">
    Utility functions used in the fastai library
  </div>
</div>


<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastcore.test <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nbdev.showdoc <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastcore.nb_imports <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> time <span class="im">import</span> sleep</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil,tempfile,pickle,random</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="file-functions" class="level2">
<h2 class="anchored" data-anchor-id="file-functions">File Functions</h2>
<p>Utilities (other than extensions to Pathlib.Path) for dealing with IO.</p>
<hr>
<section id="walk" class="level4">
<h4 class="anchored" data-anchor-id="walk">walk</h4>
<blockquote class="blockquote">
<pre><code> walk (path:Union[pathlib.Path,str], symlinks:bool=True, keep_file:&lt;built-
       infunctioncallable&gt;=&lt;functionnoopat0x104a181f0&gt;,
       keep_folder:&lt;built-infunctioncallable&gt;=&lt;functionnoopat0x104a181f0&gt;,
       skip_folder:&lt;built-infunctioncallable&gt;=&lt;functionnoopat0x104a181f0&gt;,
       func:&lt;built-infunctioncallable&gt;=&lt;functionjoinat0x1047e3c10&gt;)</code></pre>
</blockquote>
<p>Generator version of <code>os.walk</code>, using functions to filter files and folders</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>path</td>
<td>Path | str</td>
<td></td>
<td>path to start searching</td>
</tr>
<tr class="even">
<td>symlinks</td>
<td>bool</td>
<td>True</td>
<td>follow symlinks?</td>
</tr>
<tr class="odd">
<td>keep_file</td>
<td>callable</td>
<td>noop</td>
<td>function that returns True for wanted files</td>
</tr>
<tr class="even">
<td>keep_folder</td>
<td>callable</td>
<td>noop</td>
<td>function that returns True for folders to enter</td>
</tr>
<tr class="odd">
<td>skip_folder</td>
<td>callable</td>
<td>noop</td>
<td>function that returns True for folders to skip</td>
</tr>
<tr class="even">
<td>func</td>
<td>callable</td>
<td>join</td>
<td>function to apply to each matched file</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="globtastic" class="level4">
<h4 class="anchored" data-anchor-id="globtastic">globtastic</h4>
<blockquote class="blockquote">
<pre><code> globtastic (path:Union[pathlib.Path,str], recursive:bool=True,
             symlinks:bool=True, file_glob:str=None, file_re:str=None,
             folder_re:str=None, skip_file_glob:str=None,
             skip_file_re:str=None, skip_folder_re:str=None, func:&lt;built-
             infunctioncallable&gt;=&lt;functionjoinat0x1047e3c10&gt;)</code></pre>
</blockquote>
<p>A more powerful <code>glob</code>, including regex matches, symlink handling, and skip parameters</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>path</td>
<td>Path | str</td>
<td></td>
<td>path to start searching</td>
</tr>
<tr class="even">
<td>recursive</td>
<td>bool</td>
<td>True</td>
<td>search subfolders</td>
</tr>
<tr class="odd">
<td>symlinks</td>
<td>bool</td>
<td>True</td>
<td>follow symlinks?</td>
</tr>
<tr class="even">
<td>file_glob</td>
<td>str</td>
<td>None</td>
<td>Only include files matching glob</td>
</tr>
<tr class="odd">
<td>file_re</td>
<td>str</td>
<td>None</td>
<td>Only include files matching regex</td>
</tr>
<tr class="even">
<td>folder_re</td>
<td>str</td>
<td>None</td>
<td>Only enter folders matching regex</td>
</tr>
<tr class="odd">
<td>skip_file_glob</td>
<td>str</td>
<td>None</td>
<td>Skip files matching glob</td>
</tr>
<tr class="even">
<td>skip_file_re</td>
<td>str</td>
<td>None</td>
<td>Skip files matching regex</td>
</tr>
<tr class="odd">
<td>skip_folder_re</td>
<td>str</td>
<td>None</td>
<td>Skip folders matching regex,</td>
</tr>
<tr class="even">
<td>func</td>
<td>callable</td>
<td>join</td>
<td>function to apply to each matched file</td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>L</strong></td>
<td></td>
<td><strong>Paths to matched files</strong></td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>globtastic(<span class="st">'.'</span>, skip_folder_re<span class="op">=</span><span class="st">'^[_.]'</span>, folder_re<span class="op">=</span><span class="st">'core'</span>, file_glob<span class="op">=</span><span class="st">'*.*py*'</span>, file_re<span class="op">=</span><span class="st">'c'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(#5) ['./fastcore/docments.py','./fastcore/dispatch.py','./fastcore/basics.py','./fastcore/docscrape.py','./fastcore/script.py']</code></pre>
</div>
</div>
<hr>
</section>
<section id="maybe_open" class="level4">
<h4 class="anchored" data-anchor-id="maybe_open">maybe_open</h4>
<blockquote class="blockquote">
<pre><code> maybe_open (f, mode='r', **kwargs)</code></pre>
</blockquote>
<p>Context manager: open <code>f</code> if it is a path (and close on exit)</p>
<p>This is useful for functions where you want to accept a path <em>or</em> file. <a href="https://fastcore.fast.ai/xtras.html#maybe_open">maybe_open</a> will not close your file handle if you pass one in.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _f(fn):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> maybe_open(fn) <span class="im">as</span> f: <span class="cf">return</span> f.encoding</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>fname <span class="op">=</span> <span class="st">'00_test.ipynb'</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>sys_encoding <span class="op">=</span> <span class="st">'cp1252'</span> <span class="cf">if</span> sys.platform <span class="op">==</span> <span class="st">'win32'</span> <span class="cf">else</span> <span class="st">'UTF-8'</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>test_eq(_f(fname), sys_encoding)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(fname) <span class="im">as</span> fh: test_eq(_f(fh), sys_encoding)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For example, we can use this to reimplement <a href="https://docs.python.org/3/library/imghdr.html#imghdr.what"><code>imghdr.what</code></a> from the Python standard library, which is <a href="https://github.com/python/cpython/blob/3.9/Lib/imghdr.py#L11">written in Python 3.9</a> as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> what(<span class="bu">file</span>, h<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> imghdr</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> <span class="va">None</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> h <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(<span class="bu">file</span>, (<span class="bu">str</span>,os.PathLike)):</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                f <span class="op">=</span> <span class="bu">open</span>(<span class="bu">file</span>, <span class="st">'rb'</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                h <span class="op">=</span> f.read(<span class="dv">32</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                location <span class="op">=</span> <span class="bu">file</span>.tell()</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>                h <span class="op">=</span> <span class="bu">file</span>.read(<span class="dv">32</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                <span class="bu">file</span>.seek(location)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> tf <span class="kw">in</span> imghdr.tests:</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>            res <span class="op">=</span> tf(h, f)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> res: <span class="cf">return</span> res</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">finally</span>:</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> f: f.close()</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s an example of the use of this function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>fname <span class="op">=</span> <span class="st">'images/puppy.jpg'</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>what(fname)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'jpeg'</code></pre>
</div>
</div>
<p>With <a href="https://fastcore.fast.ai/xtras.html#maybe_open">maybe_open</a>, <a href="https://fastcore.fast.ai/basics.html#self">Self</a>, and <a href="https://fastcore.fast.ai/foundation.html#l.map_first">L.map_first</a>, we can rewrite this in a much more concise and (in our opinion) clear way:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> imghdr</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> what(<span class="bu">file</span>, h<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> h <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> maybe_open(<span class="bu">file</span>, <span class="st">'rb'</span>) <span class="im">as</span> f: h <span class="op">=</span> f.peek(<span class="dv">32</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> L(imghdr.tests).map_first(Self(h,<span class="bu">file</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>…and we can check that it still works:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>test_eq(what(fname), <span class="st">'jpeg'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>…along with the version passing a file handle:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(fname,<span class="st">'rb'</span>) <span class="im">as</span> f: test_eq(what(f), <span class="st">'jpeg'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>…along with the <code>h</code> parameter version:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(fname,<span class="st">'rb'</span>) <span class="im">as</span> f: test_eq(what(<span class="va">None</span>, h<span class="op">=</span>f.read(<span class="dv">32</span>)), <span class="st">'jpeg'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="image_size" class="level4">
<h4 class="anchored" data-anchor-id="image_size">image_size</h4>
<blockquote class="blockquote">
<pre><code> image_size (fn)</code></pre>
</blockquote>
<p>Tuple of (w,h) for png, gif, or jpg; <code>None</code> otherwise</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>test_eq(image_size(fname), (<span class="dv">1200</span>,<span class="dv">803</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="bunzip" class="level4">
<h4 class="anchored" data-anchor-id="bunzip">bunzip</h4>
<blockquote class="blockquote">
<pre><code> bunzip (fn)</code></pre>
</blockquote>
<p>bunzip <code>fn</code>, raising exception if output already exists</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> Path(<span class="st">'files/test.txt'</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> f.exists(): f.unlink()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>bunzip(<span class="st">'files/test.txt.bz2'</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> f.<span class="bu">open</span>().readlines()</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">len</span>(t),<span class="dv">1</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>test_eq(t[<span class="dv">0</span>], <span class="st">'test</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>f.unlink()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="loads" class="level4">
<h4 class="anchored" data-anchor-id="loads">loads</h4>
<blockquote class="blockquote">
<pre><code> loads (s, **kw)</code></pre>
</blockquote>
<p>Same as <code>json.loads</code>, but handles <code>None</code></p>
<hr>
</section>
<section id="loads_multi" class="level4">
<h4 class="anchored" data-anchor-id="loads_multi">loads_multi</h4>
<blockquote class="blockquote">
<pre><code> loads_multi (s:str)</code></pre>
</blockquote>
<p>Generator of &gt;=0 decoded json dicts, possibly with non-json ignored text at start and end</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>tst <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="st"># ignored</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="st">{ "a":1 }</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="st">hello</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="st">{</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="st">"b":2</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">list</span>(loads_multi(tst)), [{<span class="st">'a'</span>: <span class="dv">1</span>}, {<span class="st">'b'</span>: <span class="dv">2</span>}])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="dumps" class="level4">
<h4 class="anchored" data-anchor-id="dumps">dumps</h4>
<blockquote class="blockquote">
<pre><code> dumps (obj, **kw)</code></pre>
</blockquote>
<p>Same as <code>json.dumps</code>, but uses <code>ujson</code> if available</p>
<hr>
</section>
<section id="untar_dir" class="level4">
<h4 class="anchored" data-anchor-id="untar_dir">untar_dir</h4>
<blockquote class="blockquote">
<pre><code> untar_dir (fname, dest, rename=False, overwrite=False)</code></pre>
</blockquote>
<p>untar <code>file</code> into <code>dest</code>, creating a directory if the root contains more than one item</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test_untar(foldername, rename<span class="op">=</span><span class="va">False</span>, <span class="op">**</span>kwargs):</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> tempfile.TemporaryDirectory() <span class="im">as</span> d:</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>        nm <span class="op">=</span> os.path.join(d, <span class="st">'a'</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>        shutil.make_archive(nm, <span class="st">'gztar'</span>, <span class="op">**</span>kwargs)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> tempfile.TemporaryDirectory() <span class="im">as</span> d2:</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>            d2 <span class="op">=</span> Path(d2)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>            untar_dir(nm<span class="op">+</span><span class="st">'.tar.gz'</span>, d2, rename<span class="op">=</span>rename)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>            test_eq(d2.ls(), [d2<span class="op">/</span>foldername])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If the contents of <code>fname</code> contain just one file or directory, it is placed directly in <code>dest</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using `base_dir` in `make_archive` results in `images` directory included in file names</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>test_untar(<span class="st">'images'</span>, base_dir<span class="op">=</span><span class="st">'images'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If <code>rename</code> then the directory created is named based on the archive, without extension:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>test_untar(<span class="st">'a'</span>, base_dir<span class="op">=</span><span class="st">'images'</span>, rename<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If the contents of <code>fname</code> contain multiple files and directories, a new folder in <code>dest</code> is created with the same name as <code>fname</code> (but without extension):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using `root_dir` in `make_archive` results in `images` directory *not* included in file names</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>test_untar(<span class="st">'a'</span>, root_dir<span class="op">=</span><span class="st">'images'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="repo_details" class="level4">
<h4 class="anchored" data-anchor-id="repo_details">repo_details</h4>
<blockquote class="blockquote">
<pre><code> repo_details (url)</code></pre>
</blockquote>
<p>Tuple of <code>owner,name</code> from ssh or https git repo <code>url</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>test_eq(repo_details(<span class="st">'https://github.com/fastai/fastai.git'</span>), [<span class="st">'fastai'</span>, <span class="st">'fastai'</span>])</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>test_eq(repo_details(<span class="st">'git@github.com:fastai/nbdev.git</span><span class="ch">\n</span><span class="st">'</span>), [<span class="st">'fastai'</span>, <span class="st">'nbdev'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="run" class="level4">
<h4 class="anchored" data-anchor-id="run">run</h4>
<blockquote class="blockquote">
<pre><code> run (cmd, *rest, same_in_win=False, ignore_ex=False, as_bytes=False,
      stderr=False)</code></pre>
</blockquote>
<p>Pass <code>cmd</code> (splitting with <code>shlex</code> if string) to <code>subprocess.run</code>; return <code>stdout</code>; raise <code>IOError</code> if fails</p>
<p>You can pass a string (which will be split based on standard shell rules), a list, or pass args directly:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>run(<span class="st">'echo'</span>, same_in_win<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>run(<span class="st">'pip'</span>, <span class="st">'--version'</span>, same_in_win<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>run([<span class="st">'pip'</span>, <span class="st">'--version'</span>], same_in_win<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'pip 22.2.1 from /Users/jhoward/mambaforge/lib/python3.9/site-packages/pip (python 3.9)'</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> sys.platform <span class="op">==</span> <span class="st">'win32'</span>:</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="st">'ipynb'</span> <span class="kw">in</span> run(<span class="st">'cmd /c dir /p'</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="st">'ipynb'</span> <span class="kw">in</span> run([<span class="st">'cmd'</span>, <span class="st">'/c'</span>, <span class="st">'dir'</span>, <span class="st">'/p'</span>])</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="st">'ipynb'</span> <span class="kw">in</span> run(<span class="st">'cmd'</span>, <span class="st">'/c'</span>, <span class="st">'dir'</span>,  <span class="st">'/p'</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="st">'ipynb'</span> <span class="kw">in</span> run(<span class="st">'ls -ls'</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="st">'ipynb'</span> <span class="kw">in</span> run([<span class="st">'ls'</span>, <span class="st">'-l'</span>])</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="st">'ipynb'</span> <span class="kw">in</span> run(<span class="st">'ls'</span>, <span class="st">'-l'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Some commands fail in non-error situations, like <code>grep</code>. Use <code>ignore_ex</code> in those cases, which will return a tuple of stdout and returncode:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> sys.platform <span class="op">==</span> <span class="st">'win32'</span>:</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    test_eq(run(<span class="st">'cmd /c findstr asdfds 00_test.ipynb'</span>, ignore_ex<span class="op">=</span><span class="va">True</span>)[<span class="dv">0</span>], <span class="dv">1</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    test_eq(run(<span class="st">'grep asdfds 00_test.ipynb'</span>, ignore_ex<span class="op">=</span><span class="va">True</span>)[<span class="dv">0</span>], <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="https://fastcore.fast.ai/xtras.html#run">run</a> automatically decodes returned bytes to a <code>str</code>. Use <code>as_bytes</code> to skip that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> sys.platform <span class="op">==</span> <span class="st">'win32'</span>:</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># why I ignore as_types, because every time nbdev_clean_nbs will update \n to \r\n</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    test_eq(run(<span class="st">'cmd /c echo hi'</span>), <span class="st">'hi'</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    test_eq(run(<span class="st">'echo hi'</span>, as_bytes<span class="op">=</span><span class="va">True</span>), <span class="st">b'hi</span><span class="ch">\n</span><span class="st">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="open_file" class="level4">
<h4 class="anchored" data-anchor-id="open_file">open_file</h4>
<blockquote class="blockquote">
<pre><code> open_file (fn, mode='r', **kwargs)</code></pre>
</blockquote>
<p>Open a file, with optional compression if gz or bz2 suffix</p>
<hr>
</section>
<section id="save_pickle" class="level4">
<h4 class="anchored" data-anchor-id="save_pickle">save_pickle</h4>
<blockquote class="blockquote">
<pre><code> save_pickle (fn, o)</code></pre>
</blockquote>
<p>Save a pickle file, to a file name or opened file</p>
<hr>
</section>
<section id="load_pickle" class="level4">
<h4 class="anchored" data-anchor-id="load_pickle">load_pickle</h4>
<blockquote class="blockquote">
<pre><code> load_pickle (fn)</code></pre>
</blockquote>
<p>Load a pickle file from a file name or opened file</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> suf <span class="kw">in</span> <span class="st">'.pkl'</span>,<span class="st">'.bz2'</span>,<span class="st">'.gz'</span>:</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># delete=False is added for Windows</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># https://stackoverflow.com/questions/23212435/permission-denied-to-write-to-my-temporary-file</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> tempfile.NamedTemporaryFile(suffix<span class="op">=</span>suf, delete<span class="op">=</span><span class="va">False</span>) <span class="im">as</span> f:</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>        fn <span class="op">=</span> Path(f.name)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>        save_pickle(fn, <span class="st">'t'</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>        t <span class="op">=</span> load_pickle(fn)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    f.close()</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    test_eq(t,<span class="st">'t'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="collections" class="level2">
<h2 class="anchored" data-anchor-id="collections">Collections</h2>
<hr>
<section id="dict2obj" class="level4">
<h4 class="anchored" data-anchor-id="dict2obj">dict2obj</h4>
<blockquote class="blockquote">
<pre><code> dict2obj (d, list_func=&lt;class'fastcore.foundation.L'&gt;,
           dict_func=&lt;class'fastcore.basics.AttrDict'&gt;)</code></pre>
</blockquote>
<p>Convert (possibly nested) dicts (or lists of dicts) to <code>AttrDict</code></p>
<p>This is a convenience to give you “dotted” access to (possibly nested) dictionaries, e.g:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="op">=</span> <span class="bu">dict</span>(a<span class="op">=</span><span class="dv">1</span>, b<span class="op">=</span><span class="bu">dict</span>(c<span class="op">=</span><span class="dv">2</span>,d<span class="op">=</span><span class="dv">3</span>))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>d2 <span class="op">=</span> dict2obj(d1)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>test_eq(d2.b.c, <span class="dv">2</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>test_eq(d2.b[<span class="st">'c'</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It can also be used on lists of dicts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>_list_of_dicts <span class="op">=</span> [d1, d1]</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>ds <span class="op">=</span> dict2obj(_list_of_dicts)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>test_eq(ds[<span class="dv">0</span>].b.c, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="obj2dict" class="level4">
<h4 class="anchored" data-anchor-id="obj2dict">obj2dict</h4>
<blockquote class="blockquote">
<pre><code> obj2dict (d)</code></pre>
</blockquote>
<p>Convert (possibly nested) AttrDicts (or lists of AttrDicts) to <code>dict</code></p>
<p><a href="https://fastcore.fast.ai/xtras.html#obj2dict">obj2dict</a> can be used to reverse what is done by <a href="https://fastcore.fast.ai/xtras.html#dict2obj">dict2obj</a>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>test_eq(obj2dict(d2), d1)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>test_eq(obj2dict(ds), _list_of_dicts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="repr_dict" class="level4">
<h4 class="anchored" data-anchor-id="repr_dict">repr_dict</h4>
<blockquote class="blockquote">
<pre><code> repr_dict (d)</code></pre>
</blockquote>
<p>Print nested dicts and lists, such as returned by <code>dict2obj</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(repr_dict(d2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- a: 1
- b: 
  - c: 2
  - d: 3</code></pre>
</div>
</div>
<hr>
</section>
<section id="is_listy" class="level4">
<h4 class="anchored" data-anchor-id="is_listy">is_listy</h4>
<blockquote class="blockquote">
<pre><code> is_listy (x)</code></pre>
</blockquote>
<p><code>isinstance(x, (tuple,list,L,slice,Generator))</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> is_listy((<span class="dv">1</span>,))</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> is_listy([<span class="dv">1</span>])</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> is_listy(L([<span class="dv">1</span>]))</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> is_listy(<span class="bu">slice</span>(<span class="dv">2</span>))</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="kw">not</span> is_listy(array([<span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="mapped" class="level4">
<h4 class="anchored" data-anchor-id="mapped">mapped</h4>
<blockquote class="blockquote">
<pre><code> mapped (f, it)</code></pre>
</blockquote>
<p>map <code>f</code> over <code>it</code>, unless it’s not listy, in which case return <code>f(it)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _f(x,a<span class="op">=</span><span class="dv">1</span>): <span class="cf">return</span> x<span class="op">-</span>a</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>test_eq(mapped(_f,<span class="dv">1</span>),<span class="dv">0</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>test_eq(mapped(_f,[<span class="dv">1</span>,<span class="dv">2</span>]),[<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>test_eq(mapped(_f,(<span class="dv">1</span>,)),(<span class="dv">0</span>,))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="extensions-to-pathlib.path" class="level2">
<h2 class="anchored" data-anchor-id="extensions-to-pathlib.path">Extensions to Pathlib.Path</h2>
<p>The following methods are added to the standard python libary <a href="https://docs.python.org/3/library/pathlib.html#basic-use">Pathlib.Path</a>.</p>
<hr>
<section id="path.readlines" class="level4">
<h4 class="anchored" data-anchor-id="path.readlines">Path.readlines</h4>
<blockquote class="blockquote">
<pre><code> Path.readlines (hint=-1, encoding='utf8')</code></pre>
</blockquote>
<p>Read the content of <code>self</code></p>
<hr>
</section>
<section id="path.read_json" class="level4">
<h4 class="anchored" data-anchor-id="path.read_json">Path.read_json</h4>
<blockquote class="blockquote">
<pre><code> Path.read_json (encoding=None, errors=None)</code></pre>
</blockquote>
<p>Same as <code>read_text</code> followed by <code>loads</code></p>
<hr>
</section>
<section id="path.mk_write" class="level4">
<h4 class="anchored" data-anchor-id="path.mk_write">Path.mk_write</h4>
<blockquote class="blockquote">
<pre><code> Path.mk_write (data, encoding=None, errors=None, mode=511)</code></pre>
</blockquote>
<p>Make all parent dirs of <code>self</code>, and write <code>data</code></p>
<hr>
</section>
<section id="path.relpath" class="level4">
<h4 class="anchored" data-anchor-id="path.relpath">Path.relpath</h4>
<blockquote class="blockquote">
<pre><code> Path.relpath (start=None)</code></pre>
</blockquote>
<p>Same as <code>os.path.relpath</code>, but returns a <code>Path</code>, and resolves symlinks</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> Path(<span class="st">'../fastcore/'</span>).resolve()</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Path('/Users/jhoward/git/fastcore/fastcore')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>p.relpath(Path.cwd())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Path('../fastcore')</code></pre>
</div>
</div>
<hr>
</section>
<section id="path.ls" class="level4">
<h4 class="anchored" data-anchor-id="path.ls">Path.ls</h4>
<blockquote class="blockquote">
<pre><code> Path.ls (n_max=None, file_type=None, file_exts=None)</code></pre>
</blockquote>
<p>Contents of path as a list</p>
<p>We add an <code>ls()</code> method to <code>pathlib.Path</code> which is simply defined as <code>list(Path.iterdir())</code>, mainly for convenience in REPL environments such as notebooks.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> Path()</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> path.ls()</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">len</span>(t)<span class="op">&gt;</span><span class="dv">0</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> path.ls(<span class="dv">10</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">len</span>(t1), <span class="dv">10</span>)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">=</span> path.ls(file_exts<span class="op">=</span><span class="st">'.ipynb'</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">len</span>(t)<span class="op">&gt;</span><span class="bu">len</span>(t2)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>t[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Path('parallel_test.py')</code></pre>
</div>
</div>
<p>You can also pass an optional <code>file_type</code> MIME prefix and/or a list of file extensions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>lib_path <span class="op">=</span> (path<span class="op">/</span><span class="st">'../fastcore'</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>txt_files<span class="op">=</span>lib_path.ls(file_type<span class="op">=</span><span class="st">'text'</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">len</span>(txt_files) <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> txt_files[<span class="dv">0</span>].suffix<span class="op">==</span><span class="st">'.py'</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>ipy_files<span class="op">=</span>path.ls(file_exts<span class="op">=</span>[<span class="st">'.ipynb'</span>])</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">len</span>(ipy_files) <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> ipy_files[<span class="dv">0</span>].suffix<span class="op">==</span><span class="st">'.ipynb'</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>txt_files[<span class="dv">0</span>],ipy_files[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(Path('../fastcore/shutil.py'), Path('_parallel_win.ipynb'))</code></pre>
</div>
</div>
<p>fastai also updates the <code>repr</code> of <code>Path</code> such that, if <code>Path.BASE_PATH</code> is defined, all paths are printed relative to that path (as long as they are contained in <code>Path.BASE_PATH</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> ipy_files[<span class="dv">0</span>].absolute()</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    Path.BASE_PATH <span class="op">=</span> t.parent.parent</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    test_eq(<span class="bu">repr</span>(t), <span class="ss">f"Path('nbs/</span><span class="sc">{</span>t<span class="sc">.</span>name<span class="sc">}</span><span class="ss">')"</span>)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>: Path.BASE_PATH <span class="op">=</span> <span class="va">None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="path.delete" class="level4">
<h4 class="anchored" data-anchor-id="path.delete">Path.delete</h4>
<blockquote class="blockquote">
<pre><code> Path.delete ()</code></pre>
</blockquote>
<p>Delete a file, symlink, or directory tree</p>
</section>
</section>
<section id="reindexing-collections" class="level2">
<h2 class="anchored" data-anchor-id="reindexing-collections">Reindexing Collections</h2>
<hr>
<section id="iterlen" class="level3">
<h3 class="anchored" data-anchor-id="iterlen">IterLen</h3>
<blockquote class="blockquote">
<pre><code> IterLen ()</code></pre>
</blockquote>
<p>Base class to add iteration to anything supporting <code>__len__</code> and <code>__getitem__</code></p>
<hr>
</section>
<section id="reindexcollection" class="level3">
<h3 class="anchored" data-anchor-id="reindexcollection">ReindexCollection</h3>
<blockquote class="blockquote">
<pre><code> ReindexCollection (coll, idxs=None, cache=None,
                    tfm=&lt;functionnoopat0x104a181f0&gt;)</code></pre>
</blockquote>
<p>Reindexes collection <code>coll</code> with indices <code>idxs</code> and optional LRU cache of size <code>cache</code></p>
<p>This is useful when constructing batches or organizing data in a particular manner (i.e.&nbsp;for deep learning). This class is primarly used in organizing data for language models in fastai.</p>
<p>You can supply a custom index upon instantiation with the <code>idxs</code> argument, or you can call the <code>reindex</code> method to supply a new index for your collection.</p>
<p>Here is how you can reindex a list such that the elements are reversed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>rc<span class="op">=</span>ReindexCollection([<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>, <span class="st">'e'</span>], idxs<span class="op">=</span>[<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>])</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(rc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>['e', 'd', 'c', 'b', 'a']</code></pre>
</div>
</div>
<p>Alternatively, you can use the <code>reindex</code> method:</p>
<hr>
<section id="reindexcollection.reindex" class="level4">
<h4 class="anchored" data-anchor-id="reindexcollection.reindex">ReindexCollection.reindex</h4>
<blockquote class="blockquote">
<pre><code> ReindexCollection.reindex (idxs)</code></pre>
</blockquote>
<p>Replace <code>self.idxs</code> with idxs</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>rc<span class="op">=</span>ReindexCollection([<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>, <span class="st">'e'</span>])</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>rc.reindex([<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>])</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(rc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>['e', 'd', 'c', 'b', 'a']</code></pre>
</div>
</div>
<p>You can optionally specify a LRU cache, which uses <a href="https://docs.python.org/3/library/functools.html#functools.lru_cache">functools.lru_cache</a> upon instantiation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>sz <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> ReindexCollection(L.<span class="bu">range</span>(sz), cache<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co">#trigger a cache hit by indexing into the same element multiple times</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>t[<span class="dv">0</span>], t[<span class="dv">0</span>]</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>t._get.cache_info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>CacheInfo(hits=1, misses=1, maxsize=2, currsize=1)</code></pre>
</div>
</div>
<p>You can optionally clear the LRU cache by calling the <code>cache_clear</code> method:</p>
<hr>
</section>
<section id="reindexcollection.cache_clear" class="level4">
<h4 class="anchored" data-anchor-id="reindexcollection.cache_clear">ReindexCollection.cache_clear</h4>
<blockquote class="blockquote">
<pre><code> ReindexCollection.cache_clear ()</code></pre>
</blockquote>
<p>Clear LRU cache</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>sz <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> ReindexCollection(L.<span class="bu">range</span>(sz), cache<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co">#trigger a cache hit by indexing into the same element multiple times</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>t[<span class="dv">0</span>], t[<span class="dv">0</span>]</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>t.cache_clear()</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>t._get.cache_info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>CacheInfo(hits=0, misses=0, maxsize=2, currsize=0)</code></pre>
</div>
</div>
<hr>
</section>
<section id="reindexcollection.shuffle" class="level4">
<h4 class="anchored" data-anchor-id="reindexcollection.shuffle">ReindexCollection.shuffle</h4>
<blockquote class="blockquote">
<pre><code> ReindexCollection.shuffle ()</code></pre>
</blockquote>
<p>Randomly shuffle indices</p>
<p>Note that an ordered index is automatically constructed for the data structure even if one is not supplied.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>rc<span class="op">=</span>ReindexCollection([<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>, <span class="st">'e'</span>, <span class="st">'f'</span>, <span class="st">'g'</span>, <span class="st">'h'</span>])</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>rc.shuffle()</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(rc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>['b', 'c', 'g', 'a', 'h', 'd', 'f', 'e']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>sz <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> ReindexCollection(L.<span class="bu">range</span>(sz), cache<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">list</span>(t), <span class="bu">range</span>(sz))</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>test_eq(t[sz<span class="op">-</span><span class="dv">1</span>], sz<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>test_eq(t._get.cache_info().hits, <span class="dv">1</span>)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>t.shuffle()</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>test_eq(t._get.cache_info().hits, <span class="dv">1</span>)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>test_ne(<span class="bu">list</span>(t), <span class="bu">range</span>(sz))</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">set</span>(t), <span class="bu">set</span>(<span class="bu">range</span>(sz)))</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>t.cache_clear()</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>test_eq(t._get.cache_info().hits, <span class="dv">0</span>)</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>test_eq(t.count(<span class="dv">0</span>), <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="other-helpers" class="level2">
<h2 class="anchored" data-anchor-id="other-helpers">Other Helpers</h2>
<hr>
<section id="get_source_link" class="level4">
<h4 class="anchored" data-anchor-id="get_source_link">get_source_link</h4>
<blockquote class="blockquote">
<pre><code> get_source_link (func)</code></pre>
</blockquote>
<p>Return link to <code>func</code> in source code</p>
<p><a href="https://fastcore.fast.ai/xtras.html#get_source_link">get_source_link</a> allows you get a link to source code related to an object. For <a href="https://github.com/fastai/nbdev">nbdev</a> related projects such as fastcore, we can get the full link to a GitHub repo. For <code>nbdev</code> projects, be sure to properly set the <code>git_url</code> in <code>settings.ini</code> (derived from <code>lib_name</code> and <code>branch</code> on top of the prefix you will need to adapt) so that those links are correct.</p>
<p>For example, below we get the link to <a href="https://fastcore.fast.ai/test.html#test_eq">fastcore.test.test_eq</a>:</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastcore.test <span class="im">import</span> test_eq</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="st">'fastcore/test.py'</span> <span class="kw">in</span> get_source_link(test_eq)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> get_source_link(test_eq).startswith(<span class="st">'https://github.com/fastai/fastcore'</span>)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>get_source_link(test_eq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>'https://github.com/fastai/fastcore/tree/master/fastcore/test.py#L35'</code></pre>
</div>
</div>
<hr>
</section>
<section id="truncstr" class="level4">
<h4 class="anchored" data-anchor-id="truncstr">truncstr</h4>
<blockquote class="blockquote">
<pre><code> truncstr (s:str, maxlen:int, suf:str='…', space='')</code></pre>
</blockquote>
<p>Truncate <code>s</code> to length <code>maxlen</code>, adding suffix <code>suf</code> if truncated</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> <span class="st">'abacadabra'</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>test_eq(truncstr(w, <span class="dv">10</span>), w)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>test_eq(truncstr(w, <span class="dv">5</span>), <span class="st">'abac…'</span>)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>test_eq(truncstr(w, <span class="dv">5</span>, suf<span class="op">=</span><span class="st">''</span>), <span class="st">'abaca'</span>)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>test_eq(truncstr(w, <span class="dv">11</span>, space<span class="op">=</span><span class="st">'_'</span>), w<span class="op">+</span><span class="st">"_"</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>test_eq(truncstr(w, <span class="dv">10</span>, space<span class="op">=</span><span class="st">'_'</span>), w[:<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span><span class="st">'…'</span>)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>test_eq(truncstr(w, <span class="dv">5</span>, suf<span class="op">=</span><span class="st">'!!'</span>), <span class="st">'aba!!'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="sparkline" class="level4">
<h4 class="anchored" data-anchor-id="sparkline">sparkline</h4>
<blockquote class="blockquote">
<pre><code> sparkline (data, mn=None, mx=None, empty_zero=False)</code></pre>
</blockquote>
<p>Sparkline for <code>data</code>, with <code>None</code>s (and zero, if <code>empty_zero</code>) shown as empty column</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [<span class="dv">9</span>,<span class="dv">6</span>,<span class="va">None</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">8</span>,<span class="dv">15</span>,<span class="dv">10</span>]</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'without "empty_zero": </span><span class="sc">{</span>sparkline(data, empty_zero<span class="op">=</span><span class="va">False</span>)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'   with "empty_zero": </span><span class="sc">{</span>sparkline(data, empty_zero<span class="op">=</span><span class="va">True</span> )<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>without "empty_zero": ▅▂ ▁▂▁▃▇▅
   with "empty_zero": ▅▂ ▁▂ ▃▇▅</code></pre>
</div>
</div>
<p>You can set a maximum and minimum for the y-axis of the sparkline with the arguments <code>mn</code> and <code>mx</code> respectively:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>sparkline([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">400</span>], mn<span class="op">=</span><span class="dv">0</span>, mx<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'▂▅▇▇'</code></pre>
</div>
</div>
<hr>
</section>
<section id="modify_exception" class="level4">
<h4 class="anchored" data-anchor-id="modify_exception">modify_exception</h4>
<blockquote class="blockquote">
<pre><code> modify_exception (e:Exception, msg:str=None, replace:bool=False)</code></pre>
</blockquote>
<p>Modifies <code>e</code> with a custom message attached</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>e</td>
<td>Exception</td>
<td></td>
<td>An exception</td>
</tr>
<tr class="even">
<td>msg</td>
<td>str</td>
<td>None</td>
<td>A custom message</td>
</tr>
<tr class="odd">
<td>replace</td>
<td>bool</td>
<td>False</td>
<td>Whether to replace e.args with [msg]</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>Exception</strong></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>msg <span class="op">=</span> <span class="st">"This is my custom message!"</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: (_ <span class="cf">for</span> _ <span class="kw">in</span> ()).throw(modify_exception(<span class="pp">Exception</span>(), <span class="va">None</span>)), contains<span class="op">=</span><span class="st">''</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: (_ <span class="cf">for</span> _ <span class="kw">in</span> ()).throw(modify_exception(<span class="pp">Exception</span>(), msg)), contains<span class="op">=</span>msg)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: (_ <span class="cf">for</span> _ <span class="kw">in</span> ()).throw(modify_exception(<span class="pp">Exception</span>(<span class="st">"The first message"</span>), msg)), contains<span class="op">=</span><span class="st">"The first message This is my custom message!"</span>)</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>test_fail(<span class="kw">lambda</span>: (_ <span class="cf">for</span> _ <span class="kw">in</span> ()).throw(modify_exception(<span class="pp">Exception</span>(<span class="st">"The first message"</span>), msg, <span class="va">True</span>)), contains<span class="op">=</span><span class="st">"This is my custom message!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="round_multiple" class="level4">
<h4 class="anchored" data-anchor-id="round_multiple">round_multiple</h4>
<blockquote class="blockquote">
<pre><code> round_multiple (x, mult, round_down=False)</code></pre>
</blockquote>
<p>Round <code>x</code> to nearest multiple of <code>mult</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>test_eq(round_multiple(<span class="dv">63</span>,<span class="dv">32</span>), <span class="dv">64</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>test_eq(round_multiple(<span class="dv">50</span>,<span class="dv">32</span>), <span class="dv">64</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>test_eq(round_multiple(<span class="dv">40</span>,<span class="dv">32</span>), <span class="dv">32</span>)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>test_eq(round_multiple( <span class="dv">0</span>,<span class="dv">32</span>),  <span class="dv">0</span>)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>test_eq(round_multiple(<span class="dv">63</span>,<span class="dv">32</span>, round_down<span class="op">=</span><span class="va">True</span>), <span class="dv">32</span>)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>test_eq(round_multiple((<span class="dv">63</span>,<span class="dv">40</span>),<span class="dv">32</span>), (<span class="dv">64</span>,<span class="dv">32</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="set_num_threads" class="level4">
<h4 class="anchored" data-anchor-id="set_num_threads">set_num_threads</h4>
<blockquote class="blockquote">
<pre><code> set_num_threads (nt)</code></pre>
</blockquote>
<p>Get numpy (and others) to use <code>nt</code> threads</p>
<p>This sets the number of threads consistently for many tools, by:</p>
<ol type="1">
<li>Set the following environment variables equal to <code>nt</code>: <code>OPENBLAS_NUM_THREADS</code>,<code>NUMEXPR_NUM_THREADS</code>,<code>OMP_NUM_THREADS</code>,<code>MKL_NUM_THREADS</code></li>
<li>Sets <code>nt</code> threads for numpy and pytorch.</li>
</ol>
<hr>
</section>
<section id="join_path_file" class="level4">
<h4 class="anchored" data-anchor-id="join_path_file">join_path_file</h4>
<blockquote class="blockquote">
<pre><code> join_path_file (file, path, ext='')</code></pre>
</blockquote>
<p>Return <code>path/file</code> if file is a string or a <code>Path</code>, file otherwise</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> Path.cwd()<span class="op">/</span><span class="st">'_tmp'</span><span class="op">/</span><span class="st">'tst'</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> join_path_file(<span class="st">'tst.txt'</span>, path)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> path.exists()</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>test_eq(f, path<span class="op">/</span><span class="st">'tst.txt'</span>)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(f, <span class="st">'w'</span>) <span class="im">as</span> f_: <span class="cf">assert</span> join_path_file(f_, path) <span class="op">==</span> f_</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>shutil.rmtree(Path.cwd()<span class="op">/</span><span class="st">'_tmp'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="other-helpers-1" class="level2">
<h2 class="anchored" data-anchor-id="other-helpers-1">Other Helpers</h2>
<hr>
<section id="autostart" class="level4">
<h4 class="anchored" data-anchor-id="autostart">autostart</h4>
<blockquote class="blockquote">
<pre><code> autostart (g)</code></pre>
</blockquote>
<p>Decorator that automatically starts a generator</p>
<hr>
</section>
<section id="eventtimer" class="level3">
<h3 class="anchored" data-anchor-id="eventtimer">EventTimer</h3>
<blockquote class="blockquote">
<pre><code> EventTimer (store=5, span=60)</code></pre>
</blockquote>
<p>An event timer with history of <code>store</code> items of time <code>span</code></p>
<p>Add events with <a href="https://fastcore.fast.ai/basics.html#add">add</a>, and get number of <code>events</code> and their frequency (<code>freq</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random wait function for testing</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _randwait(): <span class="cf">yield</span> <span class="cf">from</span> (sleep(random.random()<span class="op">/</span><span class="dv">200</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>))</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> EventTimer(store<span class="op">=</span><span class="dv">5</span>, span<span class="op">=</span><span class="fl">0.03</span>)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> o <span class="kw">in</span> _randwait(): c.add(<span class="dv">1</span>)</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Num Events: </span><span class="sc">{</span>c<span class="sc">.</span>events<span class="sc">}</span><span class="ss">, Freq/sec: </span><span class="sc">{</span>c<span class="sc">.</span>freq<span class="sc">:.01f}</span><span class="ss">'</span>)</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Most recent: '</span>, sparkline(c.hist), <span class="op">*</span>L(c.hist).<span class="bu">map</span>(<span class="st">'</span><span class="sc">{:.01f}</span><span class="st">'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Num Events: 4, Freq/sec: 245.3
Most recent:  ▃▁▁▁▇ 302.8 255.9 224.8 261.0 372.3</code></pre>
</div>
</div>
<hr>
<section id="stringfmt_names" class="level4">
<h4 class="anchored" data-anchor-id="stringfmt_names">stringfmt_names</h4>
<blockquote class="blockquote">
<pre><code> stringfmt_names (s:str)</code></pre>
</blockquote>
<p>Unique brace-delimited names in <code>s</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> <span class="st">'/pulls/</span><span class="sc">{pull_number}</span><span class="st">/reviews/</span><span class="sc">{review_id}</span><span class="st">'</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>test_eq(stringfmt_names(s), [<span class="st">'pull_number'</span>,<span class="st">'review_id'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="partialformatter" class="level3">
<h3 class="anchored" data-anchor-id="partialformatter">PartialFormatter</h3>
<blockquote class="blockquote">
<pre><code> PartialFormatter ()</code></pre>
</blockquote>
<p>A <code>string.Formatter</code> that doesn’t error on missing fields, and tracks missing fields and unused args</p>
<hr>
<section id="partial_format" class="level4">
<h4 class="anchored" data-anchor-id="partial_format">partial_format</h4>
<blockquote class="blockquote">
<pre><code> partial_format (s:str, **kwargs)</code></pre>
</blockquote>
<p>string format <code>s</code>, ignoring missing field errors, returning missing and extra fields</p>
<p>The result is a tuple of <code>(formatted_string,missing_fields,extra_fields)</code>, e.g:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>res,missing,xtra <span class="op">=</span> partial_format(s, pull_number<span class="op">=</span><span class="dv">1</span>, foo<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>test_eq(res, <span class="st">'/pulls/1/reviews/</span><span class="sc">{review_id}</span><span class="st">'</span>)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>test_eq(missing, [<span class="st">'review_id'</span>])</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>test_eq(xtra, {<span class="st">'foo'</span>:<span class="dv">2</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="utc2local" class="level4">
<h4 class="anchored" data-anchor-id="utc2local">utc2local</h4>
<blockquote class="blockquote">
<pre><code> utc2local (dt:datetime.datetime)</code></pre>
</blockquote>
<p>Convert <code>dt</code> from UTC to local time</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> datetime(<span class="dv">2000</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">12</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'</span><span class="sc">{</span>dt<span class="sc">}</span><span class="ss"> UTC is </span><span class="sc">{</span>utc2local(dt)<span class="sc">}</span><span class="ss"> local time'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2000-01-01 12:00:00 UTC is 2000-01-01 22:00:00+10:00 local time</code></pre>
</div>
</div>
<hr>
</section>
<section id="local2utc" class="level4">
<h4 class="anchored" data-anchor-id="local2utc">local2utc</h4>
<blockquote class="blockquote">
<pre><code> local2utc (dt:datetime.datetime)</code></pre>
</blockquote>
<p>Convert <code>dt</code> from local to UTC time</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'</span><span class="sc">{</span>dt<span class="sc">}</span><span class="ss"> local is </span><span class="sc">{</span>local2utc(dt)<span class="sc">}</span><span class="ss"> UTC time'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2000-01-01 12:00:00 local is 2000-01-01 02:00:00+00:00 UTC time</code></pre>
</div>
</div>
<hr>
</section>
<section id="trace" class="level4">
<h4 class="anchored" data-anchor-id="trace">trace</h4>
<blockquote class="blockquote">
<pre><code> trace (f)</code></pre>
</blockquote>
<p>Add <code>set_trace</code> to an existing function <code>f</code></p>
<p>You can add a breakpoint to an existing function, e.g:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>Path.cwd <span class="op">=</span> trace(Path.cwd)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>Path.cwd()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now, when the function is called it will drop you into the debugger. Note, you must issue the <code>s</code> command when you begin to step into the function that is being traced.</p>
<hr>
</section>
<section id="modified_env" class="level4">
<h4 class="anchored" data-anchor-id="modified_env">modified_env</h4>
<blockquote class="blockquote">
<pre><code> modified_env (*delete, **replace)</code></pre>
</blockquote>
<p>Context manager temporarily modifying <code>os.environ</code> by deleting <code>delete</code> and replacing <code>replace</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># USER isn't in Cloud Linux Environments</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>env_test <span class="op">=</span> <span class="st">'USERNAME'</span> <span class="cf">if</span> sys.platform <span class="op">==</span> <span class="st">"win32"</span> <span class="cf">else</span> <span class="st">'SHELL'</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>oldusr <span class="op">=</span> os.environ[env_test]</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>replace_param <span class="op">=</span> {env_test: <span class="st">'a'</span>}</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> modified_env(<span class="st">'PATH'</span>, <span class="op">**</span>replace_param):</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>    test_eq(os.environ[env_test], <span class="st">'a'</span>)</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="st">'PATH'</span> <span class="kw">not</span> <span class="kw">in</span> os.environ</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="st">'PATH'</span> <span class="kw">in</span> os.environ</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>test_eq(os.environ[env_test], oldusr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="contextmanagers" class="level3">
<h3 class="anchored" data-anchor-id="contextmanagers">ContextManagers</h3>
<blockquote class="blockquote">
<pre><code> ContextManagers (mgrs)</code></pre>
</blockquote>
<p>Wrapper for <code>contextlib.ExitStack</code> which enters a collection of context managers</p>
<hr>
<section id="shufflish" class="level4">
<h4 class="anchored" data-anchor-id="shufflish">shufflish</h4>
<blockquote class="blockquote">
<pre><code> shufflish (x, pct=0.04)</code></pre>
</blockquote>
<p>Randomly relocate items of <code>x</code> up to <code>pct</code> of <code>len(x)</code> from their starting location</p>
<hr>
</section>
<section id="console_help" class="level4">
<h4 class="anchored" data-anchor-id="console_help">console_help</h4>
<blockquote class="blockquote">
<pre><code> console_help (libname:str)</code></pre>
</blockquote>
<p>Show help for all console scripts from <code>libname</code></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>libname</td>
<td>str</td>
<td>name of library for console script listing</td>
</tr>
</tbody>
</table>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>